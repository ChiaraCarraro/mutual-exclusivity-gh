(()=>{var e={94:e=>{self,e.exports=(()=>{"use strict";var e={d:(t,i)=>{for(var o in i)e.o(i,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:i[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{downloadVideo:()=>u,logMediaDevices:()=>i,modalContent:()=>n,openVideoPlayback:()=>a,openVideoPreview:()=>s,startRecorder:()=>c,startStream:()=>r,stopRecorder:()=>m,stopStream:()=>d,toggleModal:()=>o,uploadVideo:()=>l});const i=(e=!0,t=!0,i=!1)=>{navigator.mediaDevices.enumerateDevices().then((o=>{o.forEach((o=>{console.log(`${e&&o.kind.toUpperCase()}, ${t&&o.label}, ${i&&o.deviceId}`)}))})).catch((e=>{console.log(e.name,e.message)}))},o=()=>{window.location.href=-1!==window.location.href.indexOf("#greeting-modal")?"#":"#greeting-modal"},n=(e="<h1>Hi</h1>",t="deeppink")=>{const i=document.getElementById("modal-content");document.getElementById("modal").style.backgroundColor=t,"#video-preview"===e?(document.getElementById("video-playback").style.display="none",i.innerHTML="",document.getElementById("video-preview").style.display="block"):"#video-playback"===e?(document.getElementById("video-preview").style.display="none",i.innerHTML="",document.getElementById("video-playback").style.display="block"):(document.getElementById("video-preview").style.display="none",document.getElementById("video-playback").style.display="none",i.innerHTML=e),window.location.href="#greeting-modal"},s=()=>{n("#video-preview","white")},a=()=>{n("#video-playback","white")},r=(e={audio:!0,video:{facingMode:"user",frameRate:15}})=>{navigator.mediaDevices.getUserMedia(e).then((e=>{window.localStream=e;const t=document.querySelector("#video-preview");"srcObject"in t?t.srcObject=e:t.src=window.URL.createObjectURL(e),t.onloadedmetadata=()=>t.play()})).catch((e=>console.log(e.name,e.message)))},d=()=>{"localStream"in window&&window.localStream.getTracks().forEach((e=>e.stop()))},c=(e={audio:!0,video:{facingMode:"user"},frameRate:15})=>{let t={mimeType:"video/webm;codecs=vp9,opus"};MediaRecorder.isTypeSupported(t.mimeType)||(console.error(`${t.mimeType} is not supported, using vp8`),t={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(t.mimeType)||(console.error(`${t.mimeType} is not supported`),t={mimeType:"video/webm"},MediaRecorder.isTypeSupported(t.mimeType)||(console.error(`${t.mimeType} is not supported`),t={mimeType:""}))),navigator.mediaDevices.getUserMedia(e).then((e=>{window.localStream=e;const i=document.querySelector("#video-preview");"srcObject"in i?i.srcObject=e:i.src=window.URL.createObjectURL(e),i.onloadedmetadata=()=>i.play(),window.MediaRecorder=new MediaRecorder(window.localStream,t),window.dataChunks=[],window.MediaRecorder.start(),console.log(window.MediaRecorder.state),window.MediaRecorder.ondataavailable=e=>window.dataChunks.push(e.data)})).catch((e=>console.log(e.name,e.message)))},m=()=>{"MediaRecorder"in window&&"recording"===window.MediaRecorder.state&&(window.MediaRecorder.stop(),console.log(window.MediaRecorder.state),window.MediaRecorder.onstop=()=>{window.blobvid=new Blob(window.dataChunks,{type:"video/webm"}),window.dataChunks=[],window.videoURL=window.URL.createObjectURL(window.blobvid),document.getElementById("video-playback").src=window.videoURL}),d()},l=(e,t="upload_video.php")=>{if(window.blobvid){const i={fname:(new Date).toISOString().replaceAll(":","-").replace(".","-"),uploadContent:"<h1>Uploading</h1>",uploadColor:"coral",successContent:"<h1>Successful</h1>",successColor:"cyan",...e};n(i.uploadContent,i.uploadColor);const o=t,s=new FormData;s.append("vidfile",window.blobvid,i.fname),fetch(o,{method:"POST",body:s}).then((()=>{n(i.successContent,i.successColor)})).catch(console.error)}else n("<h1>No recording was found 😔</h1>","PeachPuff")},u=(e="video.webm")=>{if(window.blobvid){console.log(e);const t=document.createElement("a");t.href=window.videoURL,t.download=e,t.click(),t.remove()}else console.log("No video found in window object")};return(()=>{const e=document.createElement("style");e.innerHTML="\n  /* Greeting Modal Container */\n  #greeting-modal {\n    visibility: hidden;\n    opacity: 0;\n    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);\n  }\n  \n  /* Greeting Modal Container - when open */\n  #greeting-modal:target {\n    visibility: visible;\n    opacity: 1;\n  }\n  \n  /* Greeting Modal */\n  #greeting-modal #modal {\n    opacity: 0;\n    transform: translateY(-1rem);\n    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);\n    transition-delay: 0.1s;\n  }\n  \n  /* Greeting Modal - when open */\n  #greeting-modal:target #modal {\n  transform: translateY(0);\n  opacity: 1;\n  }\n  \n  /* Modal Container Styles for flex box */\n  .modal-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    backdrop-filter: blur(5px);\n  }\n  \n  /* Modal Background Styles */\n  .modal-bg {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.3);\n    backdrop-filter: blur(5px);\n  }\n  \n  /* Modal Body Styles */\n  #modal {\n    z-index: 1;\n    background-color: white;\n    width: max-content; /* 500px */\n    padding: 1rem;\n    border-radius: 8px;\n  }\n  \n  #modal .close {\n    position: absolute;\n    right: -16px;\n    top: -16px;\n    width: 32px;\n    height: 32px;\n    opacity: 0.3;\n  }\n  #modal .close:hover {\n    opacity: 1;\n  }\n\n  #modal .close:before, .close:after {\n    position: absolute;\n    left: 16px;\n    content: ' ';\n    height: 34px;\n    width: 3px;\n    background-color: #333;\n  }\n  #modal .close:before {\n    transform: rotate(45deg);\n  }\n  #modal .close:after {\n    transform: rotate(-45deg);\n  }\n  \n  \n",document.head.appendChild(e);const t=document.createRange().createContextualFragment('\n  \x3c!-- Modal container --\x3e\n  <div class="modal-container" id="greeting-modal">\n\n    \x3c!-- Modal  --\x3e\n    <div id="modal">\n      <video id="video-preview" muted style="display: none;"></video>\n      <video id="video-playback" controls style="display: none"></video>\n      <div id="modal-content"></div>\n      <a href="#" class="close">\n    </div>\n\n    \x3c!-- Background, click to close --\x3e\n    <a href="#" class="modal-bg"></a>\n  </div>\n');document.body.appendChild(t)})(),t})()},515:(e,t,i)=>{"use strict";var o;!function(){var n,s="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if("object"==typeof process&&"object"==typeof process.versions&&process.versions.node&&!process.browser){var a=process.versions.node.toString().replace("v","");s="Nodejs/"+a+" (NodeOS) AppleWebKit/"+a+" (KHTML, like Gecko) Nodejs/"+a+" Nodejs/"+a}n=void 0!==i.g?i.g:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==i.g&&(i.g.navigator={userAgent:s,getUserMedia:function(){}},n.window=i.g),"undefined"==typeof location&&(n.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(n.screen={width:0,height:0}));var r=window.navigator;void 0!==r?(void 0!==r.webkitGetUserMedia&&(r.getUserMedia=r.webkitGetUserMedia),void 0!==r.mozGetUserMedia&&(r.getUserMedia=r.mozGetUserMedia)):r={getUserMedia:function(){},userAgent:s};var d=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(r.userAgent||""),c=!(-1===r.userAgent.indexOf("Edge")||!r.msSaveOrOpenBlob&&!r.msSaveBlob),m=!!window.opera||r.userAgent.indexOf(" OPR/")>=0,l=r.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(r.userAgent),u=/^((?!chrome|android).)*safari/i.test(r.userAgent),p=!!window.chrome&&!m,g="undefined"!=typeof document&&!!document.documentMode&&!c;function f(e,t){var i=0,o=!1,n=window.setInterval((function(){e()&&(window.clearInterval(n),t(o)),i++>50&&(window.clearInterval(n),t(o=!0))}),10)}var w,v,_={Android:function(){return r.userAgent.match(/Android/i)},BlackBerry:function(){return r.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return r.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return r.userAgent.match(/Opera Mini/i)},Windows:function(){return r.userAgent.match(/IEMobile/i)},any:function(){return _.Android()||_.BlackBerry()||_.iOS()||_.Opera()||_.Windows()},getOsName:function(){var e="Unknown OS";return _.Android()&&(e="Android"),_.BlackBerry()&&(e="BlackBerry"),_.iOS()&&(e="iOS"),_.Opera()&&(e="Opera Mini"),_.Windows()&&(e="Windows"),e}},h="Unknown OS",b="Unknown OS Version",y=function(){for(var e,t=r.appVersion,i=r.userAgent,o="-",n=[{s:"Chrome OS",r:/CrOS/},{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],s=0;e=n[s];s++)if(e.r.test(i)){o=e.s;break}var a="-";switch(/Windows/.test(o)&&(/Windows (.*)/.test(o)&&(a=/Windows (.*)/.exec(o)[1]),o="Windows"),o){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(i)&&(a=/Mac OS X (10[\.\_\d]+)/.exec(i)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(i)&&(a=/Android ([\.\_\d]+)/.exec(i)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(i)&&(a=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))&&a.length>3&&(a=a[1]+"."+a[2]+"."+(0|a[3]))}return{osName:o,osVersion:a}}();y&&y.osName&&"-"!=y.osName?(h=y.osName,b=y.osVersion):_.any()&&"Android"==(h=_.getOsName())&&(b=!!(v=(w=(w||r.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&v[1]);var S="object"==typeof process&&"object"==typeof process.versions&&process.versions.node;"Unknown OS"===h&&S&&(h="Nodejs",b=process.versions.node.toString().replace("v",""));var k=!1,C=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!k&&e in document.createElement("canvas")&&(k=!0),!C&&e in document.createElement("video")&&(C=!0))}));var O=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,M=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,x=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,T=[],W=[],I=[],E=[];r.mediaDevices&&r.mediaDevices.enumerateDevices&&(r.enumerateDevices=function(e){var t=r.mediaDevices.enumerateDevices();t&&t.then?r.mediaDevices.enumerateDevices().then(e).catch((function(){e([])})):e([])});var D=!1;("undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack||r.mediaDevices&&r.mediaDevices.enumerateDevices)&&(D=!0);var B=!1,P=!1,R=!1,A=!1,N=!1;var j=window.DetectRTC||{};j.browser=function(){r.appVersion;var e,t,i,o=r.userAgent,n=r.appName,s=""+parseFloat(r.appVersion),a=parseInt(r.appVersion,10);if(m){n="Opera";try{a=(s=r.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){s="0.0.0.0",a=0}}else g?((t=o.indexOf("rv:"))>0?s=o.substring(t+3):(t=o.indexOf("MSIE"),s=o.substring(t+5)),n="IE"):p?(t=o.indexOf("Chrome"),n="Chrome",s=o.substring(t+7)):u?-1!==o.indexOf("CriOS")?(t=o.indexOf("CriOS"),n="Chrome",s=o.substring(t+6)):-1!==o.indexOf("FxiOS")?(t=o.indexOf("FxiOS"),n="Firefox",s=o.substring(t+6)):(t=o.indexOf("Safari"),n="Safari",s=o.substring(t+7),-1!==(t=o.indexOf("Version"))&&(s=o.substring(t+8)),-1!==r.userAgent.indexOf("Version/")&&(s=r.userAgent.split("Version/")[1].split(" ")[0])):l?(t=o.indexOf("Firefox"),n="Firefox",s=o.substring(t+8)):(e=o.lastIndexOf(" ")+1)<(t=o.lastIndexOf("/"))&&(n=o.substring(e,t),s=o.substring(t+1),n.toLowerCase()===n.toUpperCase()&&(n=r.appName));return c&&(n="Edge",s=r.userAgent.split("Edge/")[1]),-1!==(i=s.search(/[; \)]/))&&(s=s.substring(0,i)),a=parseInt(""+s,10),isNaN(a)&&(s=""+parseFloat(r.appVersion),a=parseInt(r.appVersion,10)),{fullVersion:s,version:a,name:n,isPrivateBrowsing:!1}}(),function(){var e;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,(function(){e=!1}),(function(t){e=!0}));else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var t;try{(t=window.indexedDB.open("test")).onerror=function(){return!0}}catch(t){e=!0}void 0===e&&f((function(){return"done"===t.readyState}),(function(i){i||(e=!t.result)}))}else if(function(){var e=window.navigator.userAgent.toLowerCase();if(0===e.indexOf("msie")&&0===e.indexOf("trident"))return!1;var t=/(?:msie|rv:)\s?([\d\.]+)/.exec(e);return!!(t&&parseInt(t[1],10)>=10)}()){e=!1;try{window.indexedDB||(e=!0)}catch(t){e=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(t){e=!0}void 0===e&&(e=!1,window.localStorage.removeItem("test"))}}catch(t){e=!1}f((function(){return void 0!==e}),(function(t){var i;i=e,j.browser.isPrivateBrowsing=!!i}))}(),j.browser["is"+j.browser.name]=!0,j.osName=h,j.osVersion=b,"object"==typeof process&&"object"==typeof process.versions&&process.versions["node-webkit"];var L=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach((function(e){L||e in window&&(L=!0)})),j.isWebRTCSupported=L,j.isORTCSupported="undefined"!=typeof RTCIceGatherer;var U=!1;(j.browser.isChrome&&j.browser.version>=35||j.browser.isFirefox&&j.browser.version>=34||j.browser.isEdge&&j.browser.version>=17||"Android"===j.osName&&j.browser.isChrome)&&(U=!0),(r.getDisplayMedia||r.mediaDevices&&r.mediaDevices.getDisplayMedia)&&(U=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||"")||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(j.browser.isChrome||j.browser.isEdge||j.browser.isOpera)||j.browser.isFirefox)&&(U=!1),j.isScreenCapturingSupported=U;var F={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach((function(e){F.isSupported||e in window&&(F.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(F.isCreateMediaStreamSourceSupported=!0))})),j.isAudioContextSupported=F.isSupported,j.isCreateMediaStreamSourceSupported=F.isCreateMediaStreamSourceSupported;var $=!1;j.browser.isChrome&&j.browser.version>31&&($=!0),j.isRtpDataChannelsSupported=$;var V=!1;(j.browser.isFirefox&&j.browser.version>28||j.browser.isChrome&&j.browser.version>25||j.browser.isOpera&&j.browser.version>=11)&&(V=!0),j.isSctpDataChannelsSupported=V,j.isMobileDevice=d;var q=!1;(r.getUserMedia||r.mediaDevices&&r.mediaDevices.getUserMedia)&&(q=!0),j.browser.isChrome&&j.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(q="Requires HTTPs"),"Nodejs"===j.osName&&(q=!1),j.isGetUserMediaSupported=q;var z,G,H,X="";screen.width&&(X+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:"")),j.displayResolution=X,j.displayAspectRatio=(z=screen.width,G=screen.height,H=function e(t,i){return 0==i?t:e(i,t%i)}(z,G),z/H/(G/H)).toFixed(2),j.isCanvasSupportsStreamCapturing=k,j.isVideoSupportsStreamCapturing=C,"Chrome"==j.browser.name&&j.browser.version>=53&&(j.isCanvasSupportsStreamCapturing||(j.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),j.isVideoSupportsStreamCapturing||(j.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),j.DetectLocalIPAddress=function(e,t){if(j.isWebRTCSupported){var i=!0,o=!0;!function(e,t){if("undefined"!=typeof document&&"function"==typeof document.getElementById){var i={},o=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!o){var n=document.getElementById("iframe");if(!n)return;var s=n.contentWindow;o=s.RTCPeerConnection||s.mozRTCPeerConnection||s.webkitRTCPeerConnection}if(o){var a=null;"Chrome"===j.browser&&j.browser.version<58&&(a={optional:[{RtpDataChannels:!0}]});var r=new o({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},a);if(t&&(r.addStream?r.addStream(t):r.addTrack&&t.getTracks()[0]&&r.addTrack(t.getTracks()[0],t)),r.onicecandidate=function(e){e.candidate&&e.candidate.candidate?d(e.candidate.candidate):d()},!t)try{r.createDataChannel("sctp",{})}catch(e){}j.isPromisesSupported?r.createOffer().then((function(e){r.setLocalDescription(e).then(c)})):r.createOffer((function(e){r.setLocalDescription(e,c,(function(){}))}),(function(){}))}}function d(t){if(t){var o=M.exec(t);if(o){var n=o[1];t.match(O);void 0===i[n]&&e(n),i[n]=!0}}else e()}function c(){r.localDescription.sdp.split("\n").forEach((function(e){e&&0===e.indexOf("a=candidate:")&&d(e)}))}}((function(t){t?t.match(O)?e("Local: "+t,i=!1,o):t.match(x)?e("Public: "+t,i,o=!1):e("Public: "+t,i,o):e()}),t)}},j.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,j.isWebSocketsBlocked=!j.isWebSocketsSupported,"Nodejs"===j.osName&&(j.isWebSocketsSupported=!0,j.isWebSocketsBlocked=!1),j.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,i=new WebSocket("wss://echo.websocket.org:443/");i.onopen=function(){j.isWebSocketsBlocked=!1,t=(new Date).getTime(),i.send("ping")},i.onmessage=function(){j.WebsocketLatency=(new Date).getTime()-t+"ms",e(),i.close(),i=null},i.onerror=function(){j.isWebSocketsBlocked=!0,e()}}catch(t){j.isWebSocketsBlocked=!0,e()}},j.load=function(e){!function(e){if(D)if(!r.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(r.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!r.enumerateDevices&&r.enumerateDevices&&(r.enumerateDevices=r.enumerateDevices.bind(r)),r.enumerateDevices){T=[],W=[],I=[],E=[],B=!1,P=!1,R=!1,A=!1,N=!1;var t={};r.enumerateDevices((function(i){T=[],W=[],I=[],E=[],i.forEach((function(e){var i={};for(var o in e)try{"function"!=typeof e[o]&&(i[o]=e[o])}catch(e){}t[i.deviceId+i.label+i.kind]||("audio"===i.kind&&(i.kind="audioinput"),"video"===i.kind&&(i.kind="videoinput"),i.deviceId||(i.deviceId=i.id),i.id||(i.id=i.deviceId),i.label?("videoinput"!==i.kind||N||(N=!0),"audioinput"!==i.kind||A||(A=!0)):(i.isCustomLabel=!0,"videoinput"===i.kind?i.label="Camera "+(E.length+1):"audioinput"===i.kind?i.label="Microphone "+(W.length+1):"audiooutput"===i.kind?i.label="Speaker "+(I.length+1):i.label="Please invoke getUserMedia once.",void 0!==j&&j.browser.isChrome&&j.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(i.label="HTTPs is required to get label of this "+i.kind+" device.")),"audioinput"===i.kind&&(B=!0,-1===W.indexOf(i)&&W.push(i)),"audiooutput"===i.kind&&(P=!0,-1===I.indexOf(i)&&I.push(i)),"videoinput"===i.kind&&(R=!0,-1===E.indexOf(i)&&E.push(i)),T.push(i),t[i.deviceId+i.label+i.kind]=i)})),void 0!==j&&(j.MediaDevices=T,j.hasMicrophone=B,j.hasSpeakers=P,j.hasWebcam=R,j.isWebsiteHasWebcamPermissions=N,j.isWebsiteHasMicrophonePermissions=A,j.audioInputDevices=W,j.audioOutputDevices=I,j.videoInputDevices=E),e&&e()}))}else e&&e();else e&&e()}(e=e||function(){})},j.MediaDevices=void 0!==T?T:[],j.hasMicrophone=B,j.hasSpeakers=P,j.hasWebcam=R,j.isWebsiteHasWebcamPermissions=N,j.isWebsiteHasMicrophonePermissions=A,j.audioInputDevices=W,j.audioOutputDevices=I,j.videoInputDevices=E;var K=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(K=!0),j.isSetSinkIdSupported=K;var Y=!1;j.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(Y=!0):j.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(Y=!0),j.isRTPSenderReplaceTracksSupported=Y;var J=!1;j.browser.isFirefox&&j.browser.version>38&&(J=!0),j.isRemoteStreamProcessingSupported=J;var Q=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(Q=!0),j.isApplyConstraintsSupported=Q;var Z=!1;j.browser.isFirefox&&j.browser.version>=43&&(Z=!0),j.isMultiMonitorScreenCapturingSupported=Z,j.isPromisesSupported=!!("Promise"in window),j.version="1.4.1",void 0===j&&(window.DetectRTC={});var ee=window.MediaStream;void 0===ee&&"undefined"!=typeof webkitMediaStream&&(ee=webkitMediaStream),j.MediaStream=void 0!==ee&&"function"==typeof ee&&Object.keys(ee.prototype),"undefined"!=typeof MediaStreamTrack?j.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):j.MediaStreamTrack=!1;var te=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;j.RTCPeerConnection=void 0!==te&&Object.keys(te.prototype),window.DetectRTC=j,e.exports=j,void 0===(o=function(){return j}.apply(t,[]))||(e.exports=o)}()}},t={};function i(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,i),s.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";var e=i(94),t=i(515);const o=e=>new Promise((t=>setTimeout(t,e))),n=()=>{let e=!1;if("maxTouchPoints"in navigator)e=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)e=navigator.msMaxTouchPoints>0;else{const t=window.matchMedia&&matchMedia("(pointer:coarse)");if(t&&"(pointer:coarse)"===t.media)e=!!t.matches;else if("orientation"in window)e=!0;else{const t=navigator.userAgent;e=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(t)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(t)}}return e},s=e=>{for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1)),o=e[t];e[t]=e[i],e[i]=o}return e};document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".trials");const i={meta:{subjID:new URL(document.location.href).searchParams.get("ID")||"testID",order:window.location.pathname.split("/").pop().replace(".html",""),touchscreen:n(),webcam:"true"===new URL(document.location.href).searchParams.get("webcam")||!1},data:[]};t.load((()=>{i.meta.os=t.osName,i.meta.browser=t.browser.name,i.meta.browserVersion=JSON.stringify(t.browser.version),i.meta.safari=t.browser.isSafari||!1,i.meta.iOSSafari=i.meta.touchscreen&&i.meta.safari}));let a=0,r=0,d=0;const c=document.getElementById("audio"),m=document.getElementById("trialInterface"),l=document.getElementById("objectsrow"),u=document.getElementById("between-trials"),p=document.getElementById("between-trials-background"),g=document.getElementById("mutex-button"),f=document.getElementById("speaker"),w=document.getElementById("heading-fullscreen"),v=document.getElementById("heading-testsound"),_=document.getElementById("flex-wrapper"),h=async e=>{e.preventDefault(),"character"!==e.target.id&&(d=(new Date).getTime(),Array.from(l.getElementsByTagName("img")).forEach((e=>{e.style.border="0.3vw solid transparent"})),e.target.style.border="0.3vw solid blue",a-1!=1&&a-1!=2&&a-1!=3?i.data[a]={timestamp:new Date(parseInt(d)).toISOString(),responseTime:d-r,trial:a-2,targetWord:"t",itemNr:c.src.split("/").pop().replace("n_","").replace("v_","").replace("a_","").replace("f1_","").replace("f2_","").replace("_audio.mp3",""),chosenWord:e.target.src.split("/").pop().replace("n_","").replace("v_","").replace("a_","").replace("f1_","").replace("f2_","").replace("1_","").replace("2_","").replace("3_","").replace("4_","").replace("5_","").replace("6_","").replace(".svg","").replace(".gif",""),chosenPosition:e.target.id,wordClass:c.src.split("/").pop().startsWith("n_")?"noun":c.src.split("/").pop().startsWith("v_")?"verb":c.src.split("/").pop().startsWith("a_")?"adjective":c.src.split("/").pop().startsWith("f1_")?"filler1":c.src.split("/").pop().startsWith("f2_")?"filler2":"unknown"}:a-1!=1&&a-1!=2&&a-1!=3||(i.data[a]={timestamp:new Date(parseInt(d)).toISOString(),responseTime:d-r,trial:a-2,targetWord:c.src.split("/").pop().replace(".mp3",""),itemNr:""+(a-1),chosenWord:e.target.src.split("/").pop().replace(".svg",""),chosenPosition:e.target.id,wordClass:"familiarization"}),g.addEventListener("click",W,{capture:!1,once:!0}))},b=[],y=[],S=[],k=["left","central","right"];let C=0,O=0,M=0,x=0,T=0;const W=async t=>{if(t.preventDefault(),0===a&&Promise.all(["images/items/a_1_t.svg","images/items/a_1_d1.svg","images/items/a_1_d2.svg","images/items/a_2_t.svg","images/items/a_2_d1.svg","images/items/a_2_d2.svg","images/items/a_3_t.svg","images/items/a_3_d1.svg","images/items/a_3_d2.svg","images/items/a_4_t.svg","images/items/a_4_d1.svg","images/items/a_4_d2.svg","images/items/a_5_t.svg","images/items/a_5_d1.svg","images/items/a_5_d2.svg","images/items/a_6_t.svg","images/items/a_6_d1.svg","images/items/a_6_d2.svg","images/items/n_1_t.svg","images/items/n_1_d1.svg","images/items/n_1_d2.svg","images/items/n_2_t.svg","images/items/n_2_d1.svg","images/items/n_2_d2.svg","images/items/n_3_t.svg","images/items/n_3_d1.svg","images/items/n_3_d2.svg","images/items/n_4_t.svg","images/items/n_4_d1.svg","images/items/n_4_d2.svg","images/items/n_5_t.svg","images/items/n_5_d1.svg","images/items/n_5_d2.svg","images/items/n_6_t.svg","images/items/n_6_d1.svg","images/items/n_6_d2.svg","images/items/f1_1_d1.svg","images/items/f1_1_d2.svg","images/items/f1_1_t.svg","images/items/f1_2_d1.svg","images/items/f1_2_d2.svg","images/items/f1_2_t.svg","images/items/f1_3_d1.gif","images/items/f1_3_d2.gif","images/items/f1_3_t.gif","images/items/f1_4_d1.gif","images/items/f1_4_d2.gif","images/items/f1_4_t.gif","images/items/f1_5_d1.svg","images/items/f1_5_d2.svg","images/items/f1_5_t.svg","images/items/f1_6_d1.svg","images/items/f1_6_d2.svg","images/items/f1_6_t.svg","images/items/f2_1_d1.svg","images/items/f2_1_d2.svg","images/items/f2_1_t.svg","images/items/f2_2_d1.svg","images/items/f2_2_d2.svg","images/items/f2_2_t.svg","images/items/f2_3_d1.gif","images/items/f2_3_d2.gif","images/items/f2_3_t.gif","images/items/f2_4_d1.gif","images/items/f2_4_d2.gif","images/items/f2_4_t.gif","images/items/f2_5_d1.svg","images/items/f2_5_d2.svg","images/items/f2_5_t.svg","images/items/f2_6_d1.svg","images/items/f2_6_d2.svg","images/items/f2_6_t.svg","images/items/v_1_d1.gif","images/items/v_1_d2.gif","images/items/v_1_t.gif","images/items/v_2_d1.gif","images/items/v_2_d2.gif","images/items/v_2_t.gif","images/items/v_3_d1.gif","images/items/v_3_d2.gif","images/items/v_3_t.gif","images/items/v_4_d1.gif","images/items/v_4_d2.gif","images/items/v_4_t.gif","images/items/v_5_d1.gif","images/items/v_5_d2.gif","images/items/v_5_t.gif","images/items/v_6_d1.gif","images/items/v_6_d2.gif","images/items/v_6_t.gif","audio/a_1_audio.mp3","audio/a_2_audio.mp3","audio/a_3_audio.mp3","audio/a_4_audio.mp3","audio/a_5_audio.mp3","audio/a_6_audio.mp3","audio/n_1_audio.mp3","audio/n_2_audio.mp3","audio/n_3_audio.mp3","audio/n_4_audio.mp3","audio/n_5_audio.mp3","audio/n_6_audio.mp3","audio/f1_1_audio.mp3","audio/f1_2_audio.mp3","audio/f1_3_audio.mp3","audio/f1_4_audio.mp3","audio/f1_5_audio.mp3","audio/f1_6_audio.mp3","audio/f2_1_audio.mp3","audio/f2_2_audio.mp3","audio/f2_3_audio.mp3","audio/f2_4_audio.mp3","audio/f2_5_audio.mp3","audio/f2_6_audio.mp3","audio/v_1_audio.mp3","audio/v_2_audio.mp3","audio/v_3_audio.mp3","audio/v_4_audio.mp3","audio/v_5_audio.mp3","audio/v_6_audio.mp3","audio/cat.mp3","audio/lemon.mp3","audio/plant.mp3"].map((e=>new Promise((t=>{if(e.endsWith(".mp3")){const i=new Audio;i.src=e,i.oncanplaythrough=t,i.onerror=()=>{console.warn(`Failed to preload audio: ${e}`),t()}}else{const i=new Image;i.src=e,i.onload=t,i.onerror=()=>{console.warn(`Failed to preload image: ${e}`),t()}}}))))).then((async()=>{console.log("✅ All assets preloaded"),i.meta.iOSSafari||(()=>{const e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()})(),w.style.display="none",v.style.display="inline",f.setAttribute("visibility","visible"),await o(1e3);const e=document.getElementById("testsound");if(e)try{await e.play(),console.log("✅ Test sound played")}catch(e){console.warn("⚠️ Test sound could not be played:",e)}else console.warn('⚠️ Element with ID "testsound" not found.');await o(1e3),g.disabled=!1,g.addEventListener("click",W,{capture:!1,once:!0})})),34===a){if(((e,t)=>{e.forEach((e=>{e.subjID=t,e.correct=e.targetWord===e.chosenWord}));const i=["subjID","trial","wordClass","itemNr","targetWord","chosenWord","chosenPosition","correct","timestamp","responseTime"],o=[];o.push(["id","trial","word_class","item_number","target_word","chosen_category","chosen_position","correct","timestamp","responsetime_ms"]),e.forEach((e=>{const t=i.map((t=>e[t]));o.push(t)}));let n="";o.forEach((e=>{n+=e.join(",")+"\n"}));const s=(new Date).toISOString().substring(0,10),a=(new Date).toISOString().substring(11,19),r=new Blob([n],{type:"text/csv;charset=utf-8,"}),d=URL.createObjectURL(r),c=document.createElement("a");c.setAttribute("href",d),c.setAttribute("download",`mutex-${t}-${s}-${a}.csv`),c.click()})(i.data,i.meta.subjID),((e,t)=>{e.forEach((e=>{e.subjID=t,e.correct=e.targetWord===e.chosenWord}));const i=["subjID","trial","wordClass","itemNr","targetWord","chosenWord","chosenPosition","correct","timestamp","responseTime"],o=[];o.push(["id","trial","word_class","item_number","target_word","chosen_category","chosen_position","correct","timestamp","responsetime_ms"]),e.forEach((e=>{const t=i.map((t=>e[t]));o.push(t)}));let n="";o.forEach((e=>{n+=e.join(",")+"\n"}));const s=(new Date).toISOString().substring(0,10),a=(new Date).toISOString().substring(11,19),r=new FormData;r.append("csvFile",new Blob([n],{type:"text/csv"}),`mutex-${t}-${s}-${a}.csv`),fetch("./data/data.php",{method:"POST",body:r}).then((e=>e.text())).then((e=>{console.log("Success:",e)})).catch((e=>{console.error("Error:",e)}))})(i.data,i.meta.subjID),!i.meta.iOSSafari&&i.meta.webcam){e.stopRecorder();const t=(new Date).toISOString().substring(0,10),o=(new Date).toISOString().substring(11,19);setTimeout((()=>e.downloadVideo(`mutex-${i.meta.subjID}-${t}-${o}`)),1e3)}await o(1e3),window.location.href=`./goodbye.html?ID=${i.meta.subjID}`}if(a>0){v.style.display="none";const e=document.getElementsByTagName("audio");Array.from(e).forEach((e=>{e.pause(),e.currentTime=0})),p.style.opacity=1;const t=m.getElementsByTagName("img");if(Array.from(t).forEach((e=>{"background"!==e.id&&(e.style.border="0.3vw solid transparent")})),1===a)document.getElementById("left").src="images/items/lemon.svg",document.getElementById("central").src="images/items/truck.svg",document.getElementById("right").src="images/items/turtle.svg",c.src="audio/lemon.mp3";else if(2===a)document.getElementById("left").src="images/items/helicopter.svg",document.getElementById("central").src="images/items/cat.svg",document.getElementById("right").src="images/items/choco_icecream.svg",c.src="audio/cat.mp3";else if(3===a)document.getElementById("left").src="images/items/hamster.svg",document.getElementById("central").src="images/items/orange.svg",document.getElementById("right").src="images/items/plant.svg",c.src="audio/plant.mp3";else if(a>3){const e=((e,t,i,o,n,s,a)=>{const r=["n","a","v","f1","f2"];let d,c;if(o>=2&&r.splice(r.indexOf("a"),1),i>=2&&r.splice(r.indexOf("n"),1),n>=2&&r.splice(r.indexOf("v"),1),s>=2&&r.splice(r.indexOf("f1"),1),a>=2&&r.splice(r.indexOf("f2"),1),0==r.length&&r.push("n","a","v","f1","f2"),console.log(r),2==t.length&&t[0]==t[1]){const e=r.filter((e=>e!==t[0]));d=e[Math.floor(Math.random()*e.length)]}else d=r[Math.floor(Math.random()*r.length)];2==t.length&&t.shift(),t.push(d);let m,l=[1,2,3,4,5,6];do{m=l[Math.floor(Math.random()*l.length)],l=l.filter((e=>e!==m)),console.log("ItemNmbrs:",l),c=`${d}_${m}`}while(e.includes(c)&&0!=l.length);return e.push(c),c})(b,y,C,O,M,x,T);console.log("Trial:",e),console.log("counters:",C,O,M,x,T),"a"==e.charAt(0)?O<2&&O++:"n"==e.charAt(0)?C<2&&C++:"v"==e.charAt(0)?M<2&&M++:e.startsWith("f1")?x<2&&x++:e.startsWith("f2")&&T<2&&T++,2==O&&2==C&&2==M&&2==x&&2==T&&(O=0,C=0,M=0,x=0,T=0);let t=s(k);if(S.length>=2){for(;0==(n=t[2],d=S[0],l=S[1],n!==d||n!==l);)t=s(k);S.shift()}S.push(t[2]),e.startsWith("f1_3")||e.startsWith("f1_4")||e.startsWith("f2_3")||e.startsWith("f2_4")?(document.getElementById(t[0]).src=`images/items/${e}_d1.gif`,document.getElementById(t[1]).src=`images/items/${e}_d2.gif`,document.getElementById(t[2]).src=`images/items/${e}_t.gif`):e.startsWith("v")||e.startsWith("f1_3")||e.startsWith("f1_4")||e.startsWith("f2_3")||e.startsWith("f2_4")?e.startsWith("v")&&(document.getElementById(t[0]).src=`images/items/${e}_d1.gif`,document.getElementById(t[1]).src=`images/items/${e}_d2.gif`,document.getElementById(t[2]).src=`images/items/${e}_t.gif`):(document.getElementById(t[0]).src=`images/items/${e}_d1.svg`,document.getElementById(t[1]).src=`images/items/${e}_d2.svg`,document.getElementById(t[2]).src=`images/items/${e}_t.svg`),c.src=`audio/${e}_audio.mp3`,console.log(b)}await o(150),u.style.display="none",document.body.style.backgroundSize="cover",document.body.style.backgroundPosition="center",_.style.backgroundColor="transparent",m.style.display="block",Array.from(m.getElementsByTagName("img")).forEach((e=>{const t=e.cloneNode(!0);e.replaceWith(t)}));const i=Array.from(m.getElementsByTagName("img"));c.onended=()=>{r=(new Date).getTime(),i.forEach((e=>{"character"!==e.id&&e.addEventListener("click",h,{capture:!1,once:!1})}))};try{await c.play()}catch(e){console.warn("Audio playback failed:",e)}}var n,d,l;a++};g.addEventListener("click",W,{capture:!1,once:!0}),f.addEventListener("click",(async e=>{if(e.preventDefault(),1===a){const e=document.getElementById("testsound");e?e.play():console.warn('Element with ID "testsound" not found.')}else a>1&&(a>1&&(c.pause(),c.currentTime=0),c?c.play():console.warn('Element with ID "audio" not found.'))}),{capture:!1,once:!1}),(async()=>{await o(500),!i.meta.iOSSafari&&i.meta.webcam&&e.startRecorder({audio:!0,video:{frameRate:{min:10,ideal:25,max:30},width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080},facingMode:"user"}}),await o(2500),g.style.display="inline",g.disabled=!1})()}))})()})();